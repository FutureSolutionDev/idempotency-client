# ุฏููู ุงุณุชุฎุฏุงู Idempotency Store ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (Frontend)

ููุถุญ ูุฐุง ุงููุณุชูุฏ ููููุฉ ุงุณุชุฎุฏุงู ููุงุณ IdempotencyStore ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ. ุชู ุชุตููู ูุฐุง ุงูููุงุณ ููุณุงุนุฏุชู ูู ุฅุฏุงุฑุฉ ููุงุชูุญ ุงูุฅุฏููุจูุชูุณู (idempotency keys) ูุชุฎุฒูู ุงูุงุณุชุฌุงุจุงุช ุจุดูู ูุญูู (ูุซู: IndexedDB) ูุชุฌูุจ ุงูุชูุฑุงุฑ ูู ุงูุฅุฑุณุงู ุฃู ุงูุงุณุชุฏุนุงุก.

---

## ุงููุบุงุช ุงููุฏุนููุฉ

- [ุงูุนุฑุจูุฉ](https://github.com/FutureSolutionDev/idempotency-client/tree/main/docs/ar.md)
- [English](https://github.com/FutureSolutionDev/idempotency-client/tree/main/docs/en.md)

---

## ูุง ูู ุงูุฅุฏููุจูุชูุณู Idempotencyุ

ุงูุฅุฏููุจูุชูุณู ุชุนูู ุฃู ุชูุฑุงุฑ ููุณ ุงูุนูููุฉ ุนุฏุฉ ูุฑุงุช ุณููุชุฌ ุนูู ููุณ ุงููุชูุฌุฉ ุฏุงุฆููุง. ูู ุชุทุจููุงุช ุงููุงุฌูุฉ ุงูุฃูุงููุฉุ ูุฐุง ูุถูู ุฃู ุฅุนุงุฏุฉ ูุญุงููุฉ ุงูุทูุจ (ูุซู ุฅุฑุณุงู ูููุฐุฌ) ูู ูุชุณุจุจ ูู ุชูุฑุงุฑ ุงูุจูุงูุงุช.

ุชููุฏ ูุฐู ุงูุฃุฏุงุฉ ูู ุญุงูุงุช ูุซู:

- ุฅุฑุณุงู ุนูููุงุช ุงูุฏูุน ุฃู ุงูุดุฑุงุก
- ุฅุฑุณุงู ุงูููุงุฐุฌ
- ุงูุชุฎุฒูู ุงููุคูุช ููุงุณุชุฌุงุจุงุช ุนูุฏ ุงูุนูู ุฏูู ุงุชุตุงู

---

## ููุงุฐุง ูุณุชุฎุฏู ุงูุฅุฏููุจูุชูุณูุ

- ุชุฌูุจ ุงูุชูุฑุงุฑ ูู ุงูุทูุจุงุช
- ุถูุงู ุงุณุชุฌุงุจุงุช ูุชุทุงุจูุฉ ุนูุฏ ุงูุชูุฑุงุฑ
- ุชุญุณูู ุงูุฃุฏุงุก
- ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

---

## ูู ูุฐู ุงูููุชุจุฉ ูุชูุงููุฉ ูุน ุงูุฎูููุฉ (Backend)ุ

ูุนูุ ูุฐู ุงูููุชุจุฉ ูุชูุงููุฉ ูุน Middleware ุงูุฅุฏููุจูุชูุณู ูู ุงูุฎูููุฉุ ูุงูุฐู ูุถูู ูุนุงูุฌุฉ ูู ุทูุจ ูุฑุฉ ูุงุญุฏุฉ ููุท ูุฅุฑุฌุงุน ููุณ ุงููุชูุฌุฉ.

๐ [ุงูุฑุฃ ุฏููู ุงูุฎูููุฉ](https://github.com/FutureSolutionDev/idempotency-backend)

---

## ุงูุชุซุจูุช

```bash
npm install idempotency-client
```

- `UUID()` - ุชูุณุชุฎุฏู ูุฅูุดุงุก ูุนุฑู ูุฑูุฏ

---

## ุงูุฏูุงู ุงูุฃุณุงุณูุฉ

### `CreateKey(requestId: string, ttlMs?: number): Promise<string>`

ููุดุฆ ููุชุงุญ ุฅุฏููุจูุชูุณู ุฌุฏูุฏ ููุทูุจุ ูุน ุฅููุงููุฉ ุชุญุฏูุฏ ูุฏุฉ ุตูุงุญูุฉ ุงุฎุชูุงุฑูุฉ.

### `GetKey(requestId: string): Promise<string | null>`

ูุนูุฏ ุงูููุชุงุญ ุงููุฎุฒู ููุทูุจ ุงููุญุฏุฏ ุฅู ูู ููู ููุชูู ุงูุตูุงุญูุฉ.

### `SaveResponse(requestId: string, responseData: any): Promise<void>`

ูุญูุธ ุจูุงูุงุช ุงูุงุณุชุฌุงุจุฉ ุงููุฑุชุจุทุฉ ุจู requestId.

### `GetResponse(requestId: string): Promise<any>`

ูุณุชุฑุฌุน ุจูุงูุงุช ุงูุงุณุชุฌุงุจุฉ ูู ุงูุชุฎุฒูู ุฅู ูุฌุฏุช.

### `Clear(requestId: string): Promise<void>`

ูุญุฐู ุงูููุชุงุญ ูุจูุงูุงุช ุงูุงุณุชุฌุงุจุฉ ุงููุฎุฒูุฉ ููุทูุจ.

### `ExportStore(): Promise<string>`

ูุตุฏุฑ ุฌููุน ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ุนูู ููุฆุฉ JSON (ูููุฏ ููุณุฎ ุงุญุชูุงุทู).

### `ImportStore(jsonData: string): Promise<void>`

ูุณุชุนูุฏ ุงูุจูุงูุงุช ูู ุณูุณูุฉ JSON.

### `AutoCleanup(thresholdMs?: number): Promise<void>`

ูุฒูู ุงูุฅุฏุฎุงูุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ ุชููุงุฆููุง (ุงูุงูุชุฑุงุถู: 7 ุฃูุงู).

---

## ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู

```ts
import IdempotencyStore from 'idempotency-client';

async function handleFormSubmit() {
  const requestId = 'submit::formA';
  const key = await IdempotencyStore.CreateKey(requestId, 60000);
  const existing = await IdempotencyStore.GetResponse(requestId);
  if (existing) {
    renderFromCache(existing);
    return;
  }
  const response = await fetch('/api/submit', {
    method: 'POST',
    headers: { 'Idempotency-Key': key },
    body: JSON.stringify(data)
  });
  const result = await response.json();
  await IdempotencyStore.SaveResponse(requestId, result);
  renderResponse(result);
}
```

---

## ููุงุญุธุงุช

- ุชุฃูุฏ ูู ุฃู ุงูุฎุงุฏู ูุฏุนู ุงูุฅุฏููุจูุชูุณู ุนุจุฑ ุงูุฑุคูุณ (headers).
- ูุฌุจ ุฃู ููุซู requestId ุงูุทูุจ ุงูููุทูู ุจุดูู ูุฑูุฏ.
- ูููุถู ุชุดุบูู `AutoCleanup()` ุจุดูู ุฏูุฑู ูุชูุงุฏู ุชุฑุงูู ุงูุจูุงูุงุช.

---

## ุงูุฎูุงุตุฉ

ูููุฑ ูุฐุง ุงูููุงุณ ูุณููุฉ ููุซููุฉ ูุขููุฉ ูุชุฎุฒูู ูุชุงุฆุฌ ุงูุทูุจุงุช ูุคูุชูุง ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉุ ูุน ุฅููุงููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุฏูู ุงูุชุณุจุจ ูู ุชูุฑุงุฑ ุฃู ูุดุงูู ูู ุงูุจูุงูุงุช.